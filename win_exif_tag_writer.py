# -*- coding: UTF-8 -*-

# ------------- æ‰€éœ€è¦æ·»åŠ çš„åº“ ------------- #

# æŒ‡ä»¤å‚æ•°è§£æåº“
import argparse
# ç³»ç»Ÿè¾…åŠ©åº“
import os,sys
# exifå†™å…¥æ“ä½œåº“piexifå’Œpvexiv2
import piexif,pyexiv2

# ------------- æ‰€éœ€è¦æ·»åŠ çš„åº“ ------------- #





# https://exiv2.org/tags.html çš„è¯´æ˜ï¼š

# ã€Metadata reference tablesã€‘
# //Standard Exif Tags//
# These are the Exif tags as defined in the Exif 2.3 standard.
# IFD1 tags are not listed separately. 
# All IFD0 tags may also be present in IFD1, according to the standard. 
# The second part of the Exiv2 key of an IFD1 tag is Thumbnail (instead of Image), 
# the other two parts of the key are the same as for IFD0 tags.

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# Tag (hex)		Tag (dec)	IFD			Key						Type	Tag description										ä¸ªäººå¤‡æ³¨     #
# â€¦â€¦ â€¦â€¦ 																																#
# 0x9c9b		40091		Image		Exif.Image.XPTitle		Byte	Title tag used by Windows, encoded in UCS2			ps:æ ‡é¢˜		#
# 0x9c9c		40092		Image		Exif.Image.XPComment	Byte	Comment tag used by Windows, encoded in UCS2		ps:å¤‡æ³¨		#
# 0x9c9d		40093		Image		Exif.Image.XPAuthor		Byte	Author tag used by Windows, encoded in UCS2			ps:ä½œè€…		#
# 0x9c9e		40094		Image		Exif.Image.XPKeywords	Byte	Keywords tag used by Windows, encoded in UCS2		ps:æ ‡è®°		#
# 0x9c9f		40095		Image		Exif.Image.XPSubject	Byte	Subject tag used by Windows, encoded in UCS2		ps:ä¸»é¢˜		#
# â€¦â€¦ â€¦â€¦																																	#
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #

# USC2å°±æ˜¯pythoné‡Œçš„ï¼šencoding='utf-16'ã€‚





## æ·»åŠ å‡½æ•°
# å®šä¹‰piexifå†™exifå‡½æ•°
def pv1_write(img_path_full,choice,contents_written_into):
    try:
        # è¿™ä¸ªæ¨¡å—ä¸éœ€è¦é‡å‘½åå’Œcdæ“ä½œ
        # ä¿®æ”¹å‰è®°å½•å½“å‰æ–‡ä»¶å¤¹ä½ç½®
        # currentPath = os.getcwd()

        # å¤„ç†è·¯å¾„ä¸­çš„â€œ\â€
        img_path_full = img_path_full.replace("\\\\","/")
        img_path_full = img_path_full.replace("\\","/")

        # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        status = os.path.exists(img_path_full)
        if status != True:
            raise Exception(str("å›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼š" + img_path_full + " ä¸å­˜åœ¨"))

        # è¯»å–å½“å‰å›¾ç‰‡çš„exifä¿¡æ¯åˆ°ä¸€ä¸ªå˜é‡ã€‚å¦åˆ™å¦‚æœç›´æ¥piexif.insert()ï¼Œå›¾ç‰‡åŸæœ¬çš„exifä¼šè¢«è¦†ç›–ã€‚
        exif_dict = piexif.load(img_path_full)

        # æ ¹æ®å†™å…¥é€‰é¡¹ï¼Œä½¿ç”¨å­—å…¸ç±»å‹ï¼Œé¢„å…ˆåˆ†é…å¥½è¦ä¿®æ”¹çš„exifé¡¹
        # piexifæ¨¡å—éœ€è¦ç”¨åˆ°utf-16ç¼–ç ã€‚
        if choice == 1:
            exif_dict["0th"][40091] = bytes(str(contents_written_into), encoding='utf-16')
        elif choice == 2:
            exif_dict["0th"][40092] = bytes(str(contents_written_into), encoding='utf-16')
        elif choice == 3:
            exif_dict["0th"][40093] = bytes(str(contents_written_into), encoding='utf-16')
        elif choice == 4:
            exif_dict["0th"][40094] = bytes(str(contents_written_into), encoding='utf-16')
        elif choice == 5:
            exif_dict["0th"][40095] = bytes(str(contents_written_into), encoding='utf-16')
        # é˜²æ­¢æ„å¤–
        else:
            exif_dict["0th"][40092] = bytes(str(contents_written_into), encoding='utf-16')

        # è½¬æ¢ä¸ºbyteç±»å‹ï¼Œé€‚åº”ä¸‹ä¸€æ­¥æ“ä½œ
        exif_bytes = piexif.dump(exif_dict)
        # åœ¨åŸå›¾ç‰‡ä¸­å†™å…¥æŒ‡å®šçš„exifä¿¡æ¯
        piexif.insert(exif_bytes,img_path_full)


        # è¿™ä¸ªæ¨¡å—ä¸éœ€è¦é‡å‘½åå’Œcdæ“ä½œ
        # ä¿®æ”¹åè¿”å›ä¹‹å‰çš„ç›®å½•ï¼Œé˜²æ­¢å‡ºé”™
        # os.chdir(currentPath)
    except Exception as e:
        print(e)
        return int(2)
    else:
        return int(0)


# å®šä¹‰pyexiv2å†™exifå‡½æ•°
# pyexiv2åº“å¯¹è·¯å¾„ä¸­çš„ä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦æ”¯æŒå¾ˆå·®ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨cdåˆ°å›¾ç‰‡ç›®å½•ï¼Œé‡å‘½åå›¾ç‰‡ï¼Œæ”¹å®Œexifä»¥åè¿˜å¾—æ¢å¤åŸæ ·ã€‚
def pv2_write(img_path_full,choice,contents_written_into):
    try:
        # â˜…â˜†ä¿®æ”¹å‰è®°å½•å½“å‰æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œé¡ºå¸¦å¤„ç†è¿™ä¸ªè·¯å¾„ä¸­çš„"\"â˜…â˜†
        currentPath = os.getcwd().replace("\\\\","/")
        currentPath = currentPath.replace("\\","/")

        # å¤„ç†è·¯å¾„ä¸­çš„â€œ\â€
        img_path_full = img_path_full.replace("\\\\","/")
        img_path_full = img_path_full.replace("\\","/")

        # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        status = os.path.exists(img_path_full)
        if status != True:
            raise Exception(str("å›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼š" + img_path_full + " ä¸å­˜åœ¨"))

        # è·å–è·¯å¾„
        img_path = os.path.dirname(img_path_full)
        # è·å–æ–‡ä»¶å
        img_file_name = os.path.basename(img_path_full)

        # ç›¸å½“äºcmdå‘½ä»¤é‡Œçš„"cd"å‘½ä»¤
        if img_path == "":
            os.chdir(".")
        else:
            os.chdir(img_path)

        # é‡å‘½åæ“ä½œï¼Œä»¥é€‚åº”pyexiv2æ¨¡å—çš„è‹±æ–‡æ“ä½œã€‚
        os.rename(img_file_name,r'_target_.jpg')

        # åˆ†é…â€œå¥æŸ„â€
        i = pyexiv2.Image(r'_target_.jpg')


        # æ ¹æ®å†™å…¥é€‰é¡¹ï¼Œä½¿ç”¨å­—å…¸ç±»å‹ï¼Œé¢„å…ˆåˆ†é…å¥½è¦ä¿®æ”¹çš„exifé¡¹
        # pyexiv2æ¨¡å—ä¸éœ€è¦ç”¨åˆ°utf-16ç¼–ç ï¼Œæ¨¡å—è‡ªèº«ä¼šæ‰“ç†å¥½ç¼–ç ã€‚
        if choice == 1:
            exif_dict = {'Exif.Image.XPTitle': str(contents_written_into)}
        elif choice == 2:
            exif_dict = {'Exif.Image.XPComment': str(contents_written_into)}
        elif choice == 3:
            exif_dict = {'Exif.Image.XPAuthor': str(contents_written_into)}
        elif choice == 4:
            exif_dict = {'Exif.Image.XPKeywords': str(contents_written_into)}
        elif choice == 5:
            exif_dict = {'Exif.Image.XPSubject': str(contents_written_into)}
        # é˜²æ­¢æ„å¤–
        else:
            exif_dict = {'Exif.Image.XPComment': str(contents_written_into)}
        
        # æ‰§è¡Œä¿®æ”¹
        i.modify_exif(exif_dict)
        # å…³é—­â€œå¥æŸ„â€
        i.close

        # é‡å‘½åæ“ä½œï¼ŒæŠŠåå­—æ¢å¤æˆåŸæ¥çš„
        os.rename(r'_target_.jpg',img_file_name)


        # â˜…â˜†ä¿®æ”¹åè¿”å›ä¹‹å‰çš„ç›®å½•ï¼Œé˜²æ­¢å‡ºé”™â˜…â˜†
        os.chdir(currentPath)
    except Exception as e:
        print(e)
        return int(2)
    else:
        return int(0)




## å‡½æ•°æµ‹è¯•ï¼ˆè‡ªå·±æµ‹è¯•éœ€è¦æ”¹å˜ä¸‹é¢çš„æ–‡ä»¶è·¯å¾„ï¼‰
# pv1_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",1,"pv1_æ ‡é¢˜")
# pv1_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",2,"pv1_å¤‡æ³¨")
# pv1_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",3,"pv1_ä½œè€…")
# pv1_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",4,"pv1_æ ‡è®°")
# pv1_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",5,"pv1_ä¸»é¢˜")
# os.system("pause")
# pv2_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",1,"pv2_æ ‡é¢˜")
# pv2_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",2,"pv2_å¤‡æ³¨")
# pv2_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",3,"pv2_ä½œè€…")
# pv2_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",4,"pv2_æ ‡è®°")
# pv2_write("E:\ã€æµ‹è¯•æ–‡ä»¶å¤¹ã€‘ãŠ™ï¸â—ï¸ğŸŒ¡ï¸pythonä¿®æ”¹å›¾ç‰‡exifä¸­çš„æ ‡é¢˜å’Œå¤‡æ³¨\æµ‹è¯•.jpg",5,"pv2_ä¸»é¢˜")

# é»˜è®¤çš„exeæ–‡ä»¶å
exe_filename = '\"win_exif_tag_writer.exe\"'

# è€ƒè™‘åˆ°exeæ–‡ä»¶å¯èƒ½ä¼šè¢«é‡å‘½åï¼Œå±Šæ—¶å¸®åŠ©é‡Œçš„exeæ–‡ä»¶åä¹Ÿå¯èƒ½éœ€è¦è·Ÿç€å˜åŒ–ï¼Œæ‰€ä»¥å¢åŠ exe_choiceè¿™ä¸ªé€‰é¡¹ã€‚
# é€‰é¡¹ä¸é€šè¿‡å‘½ä»¤è¡Œä¼ é€’è¿›æ¥ï¼Œéœ€è¦åœ¨ä»£ç é‡Œæ‰‹åŠ¨æ›´æ”¹ã€‚
# å›ºå®šexeæ–‡ä»¶åï¼š0ï¼›å¯å˜exeæ–‡ä»¶åï¼š1ã€‚
# å›ºå®šexeæ–‡ä»¶åå¯ä»¥åŠ å¿«é€Ÿåº¦ï¼Œæ¯•ç«Ÿå¯å˜exeæ–‡ä»¶åéœ€è¦æœç´¢å½“å‰ç›®å½•ä¸‹çš„exeæ–‡ä»¶åã€‚
exe_name_choice = 0

if exe_name_choice == 1:
    # è·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰é¡¹ç›®åˆ°f_list
    f_list = os.listdir()
    for i in f_list:
        # æŸ¥æ‰¾æ’åœ¨ç¬¬ä¸€ä¸ªçš„exeæ–‡ä»¶çš„æ–‡ä»¶åï¼ˆå°±æ˜¯æœ¬ç¨‹åºè‡ªèº«ï¼‰
        if os.path.splitext(i)[1]  == '.exe':
            exe_filename = os.path.basename(i)
            break
    # å¦‚æœæŸ¥æ‰¾æˆåŠŸçš„è¯ï¼Œåœ¨exeæ–‡ä»¶åä¸¤è¾¹åŠ ä¸Šè‹±æ–‡åŒå¼•å·ï¼š""
    if exe_filename != '\"win_exif_tag_writer.exe\"':
        exe_filename = str('\"'+ exe_filename +'\"')


# print(exe_filename)


parser = argparse.ArgumentParser(
    formatter_class=argparse.RawTextHelpFormatter,
    usage=str(
        "\n \n"+
        "========================================================================================================"+"\n"+
        "\n"+
        "ä»‹ç»ï¼š"+"\n"+
        "  æœ¬ç¨‹åºç”¨ä»¥å‘jpgã€tiffå›¾ç‰‡æ–‡ä»¶å†™å…¥windowsç³»ç»Ÿä¸“å±çš„exifæ ‡ç­¾ã€‚"+"\n \n"+
        "æ³¨æ„äº‹é¡¹ï¼š"+"\n"+
        "  1.æœ¬ç¨‹åºé‡‡ç”¨çš„æ˜¯è¦†ç›–çš„æ–¹å¼å¯¹å•ä¸ªexifæ ‡ç­¾è¿›è¡Œå†™å…¥ï¼Œè¢«å†™å…¥çš„exifæ ‡ç­¾ä¹‹å‰çš„å†…å®¹ä¼šè¢«æ¸…é™¤ï¼ˆå¦‚æœexifèƒ½æ­£ç¡®è¯†åˆ«çš„è¯ï¼‰ï¼Œ"+"\n"+
        "    å…¶ä»–æ ‡ç­¾çš„å€¼åˆ™ä¼šè¢«ä¿ç•™ï¼Œè¿™ç‚¹å¯ä»¥æ”¾å¿ƒï¼Œä¸ä¼šä¸€æ¬¡æ€§æŠŠæ‰€æœ‰å…¶ä»–æ ‡ç­¾å…¨éƒ½æ“¦é™¤æ‰ã€‚"+"\n \n"+
        "  2.å¦‚æœä¹‹å‰ç”¨windowsè‡ªå¸¦çš„å›¾ç‰‡å±æ€§ç¼–è¾‘å·¥å…·ï¼Œæ’å…¥æˆ–ä¿®æ”¹è¿‡æœ¬ç¨‹åºå¸®åŠ©é‡Œæåˆ°çš„exifæ ‡ç­¾ï¼ˆå°¤å…¶"+"\n"+
        "    æ˜¯â€œæ ‡é¢˜â€ã€â€œä½œè€…â€ã€â€œæ ‡è®°â€ï¼‰,ä¸”æ ‡ç­¾é‡Œæœ‰æ–‡æœ¬å†…å®¹çš„è¯ï¼Œç”±äºç”¨windowsè‡ªå¸¦å·¥å…·å†™å…¥çš„æ ‡ç­¾å±æ€§çš„exifæ ¼å¼"+"\n"+
        "    å’Œæœ¬ç¨‹åºæ¥å—çš„æ ¼å¼æœ‰å·®å¼‚ï¼ˆè¡¨ç°åœ¨å›¾ç‰‡æ–‡ä»¶çš„äºŒè¿›åˆ¶é‡Œï¼Œå¯¹æ¯”ç”¨æœ¬ç¨‹åºæ’å…¥å±æ€§çš„å›¾ç‰‡ï¼Œç»è¿‡windowsæ’å…¥å±æ€§çš„å›¾ç‰‡"+"\n"+
        "    åœ¨å›¾ç‰‡æ–‡ä»¶å¤´éƒ¨ä¼šå¤šå‡ºä¸€å¤§æ®µç©ºç™½å’Œå½¢ä¼¼â€œ<xxx>.....</xxx>â€çš„ç±»xmlæ ‡ç­¾ï¼‰ï¼Œæ‰€ä»¥ç”¨æœ¬ç¨‹åºæœ‰å¾ˆå¤§å¯èƒ½æ˜¯ç›´æ¥è¦†ç›–ä¸äº†"+"\n"+
        "    è¿™äº›æ ‡ç­¾çš„å†…å®¹çš„ï¼ˆè¡¨ç°åœ¨windowsçš„å›¾ç‰‡æ–‡ä»¶å±æ€§é‡Œï¼Œæ­¤æ ‡ç­¾çš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼‰ã€‚"+"\n"+
        "  ã€ æˆ‘è¿™è¾¹ç”¨ä¸€ä¸ªjpgæ–‡ä»¶æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå¯¹åŸæ¥æœ‰æ–‡æœ¬å†…å®¹çš„æ ‡ç­¾ï¼Œç”¨æ­¤ç¨‹åºæ“ä½œåï¼Œâ€œæ ‡é¢˜â€ã€â€œä½œè€…â€æ ‡ç­¾çš„æ–‡æœ¬å†…å®¹ä¸å˜ï¼Œ"+"\n"+
        "     â€œæ ‡è®°â€è¢«è¿½åŠ äº†ä¸€ä¸ªå€¼ï¼Œâ€œå¤‡æ³¨â€å’Œâ€œä¸»é¢˜â€åˆ™èƒ½å¤ŸæˆåŠŸè¦†ç›– ã€‘"+"\n \n"+
        "    â˜…â˜† æ‰€ä»¥å»ºè®®å¯¹å±æ€§ç©ºç™½çš„å›¾ç‰‡ä½¿ç”¨è¯¥ç¨‹åºï¼Œæ¯”å¦‚åˆšåˆšç”Ÿæˆæˆ–åˆšåˆšæ‹æ‘„çš„å›¾ç‰‡ï¼›    â˜…â˜†"+"\n"+
        "    â˜…â˜† æˆ–è€…åœ¨å†™å…¥æ ‡ç­¾å‰ï¼Œç”¨windowsè‡ªå¸¦çš„å·¥å…·æˆ–è€…å…¶ä»–å·¥å…·ï¼ˆå¦‚â€œExifCleanerâ€ï¼Œâ˜…â˜†"+"\n"+
        "    â˜…â˜†    ä½†æ˜¯ä½¿ç”¨â€œExifCleanerâ€ä¼šæŠŠæ‰€æœ‰çš„exifæ ‡ç­¾å…¨åˆ é™¤æ‰ï¼‰ï¼Œæ‰‹åŠ¨æ¸…é™¤      â˜…â˜†"+"\n"+
        "    â˜…â˜† ä¹‹å‰ç”¨windowsè‡ªå¸¦å·¥å…·æ’å…¥çš„è¿™äº›æ ‡ç­¾çš„å€¼ã€‚                             â˜…â˜†"+"\n"+
        "  ã€ æˆ‘è¿™è¾¹ç”¨ä¸€ä¸ªjpgæ–‡ä»¶æµ‹è¯•äº†ä¸€ä¸‹ï¼Œç”¨windowsè‡ªå¸¦å·¥å…·æ¸…é™¤äº†windowså·¥å…·è‡ªèº«ä¹‹å‰å†™å…¥çš„æ ‡ç­¾å±æ€§åï¼Œ"+"\n"+
        "    æ˜¯èƒ½å¤Ÿç”¨æ­¤ç¨‹åºå†™å…¥æ ‡ç­¾å€¼çš„ ã€‘"+"\n \n"+
        "  3.æ˜¯â€œ2.â€çš„è¡¥å……è¯´æ˜ï¼šä¹‹å‰ç»è¿‡æœ¬ç¨‹åºæ“ä½œçš„å›¾ç‰‡ï¼Œåªè¦ä¸ç”¨windowsè‡ªå¸¦çš„å›¾ç‰‡å±æ€§ç¼–è¾‘å·¥å…·è¿›è¡Œç¼–è¾‘ï¼Œ"+"\n"+
        "    å†æ¬¡è¿è¡Œæ­¤ç¨‹åºåï¼Œæ˜¯èƒ½å¤Ÿè¦†ç›–ä¹‹å‰æ ‡ç­¾é‡Œçš„å†…å®¹çš„ã€‚"+"\n \n"+
        "  4.ç¨‹åºæ”¯æŒä»å…¶ä»–è·¯å¾„è°ƒç”¨ï¼Œä»¥ä¸‹é¢å±•ç¤ºçš„cmdçª—å£ç¤ºä¾‹ä¸ºä¾‹ï¼š"+"\n"+
        "\n"+
        "========================================================================================="+"\n"+
        " Microsoft Windows [ç‰ˆæœ¬ 10.0.19044.1706]"+"\n"+
        " (c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚"+"\n \n"+
        " E:\\ã€å­˜æ”¾å›¾ç‰‡çš„æ–‡ä»¶å¤¹ã€‘> \"D:\\win_exif_tag_writer\\bin\\win_exif_tag_writer.exe\" -write \"123456_test\" -to \"1.jpg\" -tag \"æ ‡è®°\""+"\n \n"+
        "========================================================================================="+"\n"+
        "\n"+
        "  â˜…â˜† å›¾ç‰‡æ–‡ä»¶è·¯å¾„æ”¯æŒç›¸å¯¹è·¯å¾„ï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­æ‰€ç¤ºã€‚                                                        â˜…â˜†"+"\n"+
        "  â˜…â˜† æ‰€ä»¥å®Œå…¨å¯ä»¥å°†æœ¬ç¨‹åºçš„è·¯å¾„æ·»åŠ è¿›ç³»ç»Ÿç¯å¢ƒå˜é‡â€œpathâ€ä¸­ã€‚                                            â˜…â˜†"+"\n"+
        "  â˜…â˜† è¿™æ ·å°±èƒ½ç›´æ¥åœ¨cmdçª—å£ä¸­è¾“å…¥ï¼š\"win_exif_tag_writer.exe\" -write \"123456_test\" -to \"1.jpg\" -tag \"æ ‡è®°\" â˜…â˜†"+"\n \n \n \n \n"
    ),
    # epilogé‡Œï¼Œå¦‚æœè¦è¡¨ç¤ºæ¢å¤šä¸ªè¡Œï¼Œæ¯ä¸¤ä¸ªæ¢è¡Œç¬¦ä¹‹é—´å¾—åŠ ä¸ªç©ºæ ¼æ‰èƒ½è¯†åˆ«ï¼Œæ‰€ä»¥æ¢è¡Œè¡¨ç¤ºå½¢å¼å’Œå…¶ä»–éƒ¨åˆ†ä¸åŒã€‚
    # descriptioné‡Œä¹Ÿé¡ºæ‰‹å†™æˆâ€œ\n \nâ€äº†ã€‚
    description=str(
        "å‚æ•°è¯´æ˜ï¼š"+"\n"+
        "  æœ¬ç¨‹åºçš„å‘½ä»¤è¡Œç”±4ä¸ªä¸»è¦å‚æ•°ç»„æˆï¼Œå…¶ä¸­2ä¸ªä¸ºå¿…éœ€å‚æ•°ï¼Œå¦å¤–2ä¸ªä¸ºå¯é€‰å‚æ•°ã€‚"+"\n"+
        "  è¿˜æœ‰ä¸€ä¸ªè·å–å¸®åŠ©çš„å‚æ•°\"-h\"ï¼ˆpythonåº“è‡ªå¸¦çš„ï¼‰ã€‚"+"\n"+
        "  å…¶ä¸­å‚æ•°çš„è¯´æ˜å¦‚ä¸‹æ–¹æ‰€ç¤ºï¼š"+"\n"+
        "\n \n"
    ),
    epilog=str(
        "\n"+
        "å‘½ä»¤è¡Œæ ¼å¼å¸®åŠ©ï¼š"+"\n"+
        "  æœ¬ç¨‹åºçš„å‘½ä»¤è¡Œæ ¼å¼ååˆ†çµæ´»ï¼ŒåŒä¸€ä¸ªå‚æ•°æœ‰å¾ˆå¤šå¯ç”¨çš„å‘½ä»¤å…³é”®å­—ï¼Œä¸”æ‰€æœ‰å‚æ•°çš„é¡ºåºå¯ä»¥äº’æ¢ã€‚"+"\n"+
        "  ä¸‹é¢ä»…å±•ç¤ºä¸ªäººæ¨æµ‹åœ¨é€»è¾‘æ–¹é¢æ¯”è¾ƒå¥½ç†è§£ï¼Œå®¹æ˜“è®°ä½çš„å‡ ç§æ ¼å¼æ–¹æ³•ã€‚"+"\n \n"+
        "  â€œ[ ]â€é‡Œçš„æ˜¯å¯é€‰çš„å‚æ•°ï¼Œå¦‚æœå¯é€‰å‚æ•°å’Œå¿…é€‰å‚æ•°ä¸€èµ·ç»„æˆçš„å‘½ä»¤è¡Œæ˜¯æ¯”è¾ƒå¥½è®°å¿†çš„ï¼Œè¿™ä¸ªå¯é€‰å‚æ•°ä¸ä¼šè¢«â€œ[ ]â€æ‹¬å‡ºï¼›"+"\n"+
        "  â€œ{ }â€é‡Œçš„æ˜¯ä»å¤šä¸ªä¸­é€‰å–ä¸€ä¸ªï¼Œåˆ«æ¼çœ‹äº†å¤§æ‹¬å·å‰é¢çš„â€œ-â€ã€‚"+"\n"+
        "\n \n"+
        "æ–¹æ³•1ï¼š"+"\n"+
        "      " + exe_filename + " " + "-write ã€æ–‡æœ¬å†…å®¹ã€‘ -{ to / to_file / to_img / to_jpg } ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ [ -tag ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ -use ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘ ]"+"\n"+
        "â˜…â˜† æ³¨æ„ï¼â€œ-toâ€é»˜è®¤æŒ‡å®šçš„æ˜¯ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ï¼Œä¸æ˜¯ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ï¼  â˜…â˜†"+"\n"+
        "â˜…â˜† å¦‚æœéœ€è¦æŒ‡å®šæ ‡ç­¾ï¼Œéœ€è¦ç”¨â€œ-to_tagâ€æˆ–â€œ-tagâ€ï¼Œæ€»ä¹‹è¦æœ‰\"tag\"å­—æ ·ã€‚                   â˜…â˜†"+"\n"+
        "\n \n"+
        "æ–¹æ³•2ï¼š"+"\n"+
        "      " + exe_filename + " " + "-write ã€æ–‡æœ¬å†…å®¹ã€‘ -to_tag ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ -{ file / img / jpg } ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ [ -use ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘ ]"+"\n"+
        "\n \n"+
        "æ–¹æ³•3ï¼š"+"\n"+
        "      " + exe_filename + " " + "-{ i / file / img / jpg } ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ -write ã€æ–‡æœ¬å†…å®¹ã€‘ -to_tag ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ [ -use ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘ ]"+"\n"+
        "\n \n"+
        "æ–¹æ³•4ï¼š"+"\n"+
        "      " + exe_filename + " " + "-{ i / file / img / jpg } ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ -{ tag / write_tag } ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ -{ content / text / string } ã€æ–‡æœ¬å†…å®¹ã€‘ [ -use ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘ ]"+"\n"+
        "\n \n \n \n"+
        "ç¤ºä¾‹ï¼š"+"\n"+
        "(1)" +"\n"+
        "  " + exe_filename + " " + "-write \"abcdefg_test\" -to \"E:\\folder\\path\\file.jpg\""+"\n"+
        "è¯´æ˜ï¼šå°†æ–‡æœ¬å†…å®¹\"abcdefg_test\"å†™å…¥åˆ°æ–‡ä»¶\"E:\\folder\\path\\file.jpg\"çš„exifæ ‡ç­¾â€œå¤‡æ³¨â€ä¸­ï¼Œ"+"\n"+
        "      æ²¡æœ‰\"-tag\"å‚æ•°çš„æƒ…å†µä¸‹ï¼Œç¨‹åºé»˜è®¤é€‰æ‹©çš„æ˜¯â€œå¤‡æ³¨â€ã€‚"+"\n"+
        "â˜…â˜† æ³¨æ„ï¼â€œ-toâ€é»˜è®¤æŒ‡å®šçš„æ˜¯ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘ï¼Œä¸æ˜¯ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘ï¼  â˜…â˜†"+"\n"+
        "â˜…â˜† å¦‚æœéœ€è¦æŒ‡å®šæ ‡ç­¾ï¼Œéœ€è¦ç”¨â€œ-to_tagâ€æˆ–â€œ-tagâ€ï¼Œæ€»ä¹‹è¦æœ‰\"tag\"å­—æ ·ã€‚                   â˜…â˜†"+"\n"+
        "\n \n"+
        "(2)" +"\n"+
        "  " + exe_filename + " " + "-write \"abcdefg_\" -to_tag \"5\" -img \"relative_path\\file.jpg\""+"\n"+
        "è¯´æ˜ï¼šå°†æ–‡æœ¬å†…å®¹\"abcdefg_\"å†™å…¥åˆ°æ–‡ä»¶\"relative_path\\file.jpg\"çš„exifæ ‡ç­¾â€œä¸»é¢˜â€ä¸­ï¼Œ"+"\n"+
        "      æŸ¥å‰é¢çš„å‚æ•°è¯´æ˜ï¼Œå¯çŸ¥â€œ5â€å¯¹åº”çš„æ˜¯â€œä¸»é¢˜â€ã€‚"+"\n"+
        "â˜…â˜† å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ â˜…â˜†"+"\n"+
        "\n \n"+
        "(3)" +"\n"+
        "  " + exe_filename + " " + "-write \"2023-01-01 00:00:01\" -to \"E:\\folder\\path\\file.jpg\" -tag \"æ ‡è®°\""+"\n"+
        "è¯´æ˜ï¼šå°†æ–‡æœ¬å†…å®¹\"2023-01-01 00:00:01\"å†™å…¥åˆ°æ–‡ä»¶\"E:\\folder\\path\\file.jpg\"çš„exifæ ‡ç­¾â€œæ ‡è®°â€ä¸­ã€‚"+"\n"+
        "\n \n"+
        "(4)" +"\n"+
        "  " + exe_filename + " " + "-img \"D:\\folder\\test.jpg\" -write \"123456\" -to_tag \"40093\""+"\n"+
        "è¯´æ˜ï¼šå°†æ–‡æœ¬å†…å®¹\"123456\"å†™å…¥åˆ°æ–‡ä»¶\"D:\\folder\\test.jpg\"çš„exifæ ‡ç­¾â€œä½œè€…â€ä¸­ï¼Œ"+"\n"+
        "      æŸ¥å‰é¢çš„å‚æ•°è¯´æ˜ï¼Œå¯çŸ¥â€œ40093â€å¯¹åº”çš„æ˜¯â€œä½œè€…â€ã€‚"+"\n"+
        "\n \n"+
        "(5)" +"\n"+
        "  " + exe_filename + " " + "-i \"D:\\folder\\test.jpg\" -write_tag \"XPTitle\" -text \"123456\" [ -use \"pyexiv2\" ]"+"\n"+
        "è¯´æ˜ï¼šå°†æ–‡æœ¬å†…å®¹\"123456\"å†™å…¥åˆ°æ–‡ä»¶\"D:\\folder\\test.jpg\"çš„exifæ ‡ç­¾â€œæ ‡é¢˜â€ä¸­ï¼Œ"+"\n"+
        "      æŸ¥å‰é¢çš„å‚æ•°è¯´æ˜ï¼Œå¯çŸ¥â€œXPTitleâ€å¯¹åº”çš„æ˜¯â€œä½œè€…â€ã€‚"+"\n"+
        "      \"-i\"ä¹Ÿæ˜¯ffmpegçš„å¯¼å…¥æ–‡ä»¶å‘½ä»¤ï¼Œç”¨è¿‡ffmpegçš„æ¯”è¾ƒå¥½é€‚åº”ï¼Œæ‰€ä»¥åŠ äº†è¿™ä¸ª\"-i\"è¿›æ¥ï¼›"+"\n"+
        "      è¿›è¡Œå†™å…¥æ“ä½œçš„æ˜¯pythonçš„pyexiv2åº“ã€‚"+"\n \n"+
        "   ã€ æ³¨ï¼šé»˜è®¤æƒ…å†µä¸‹ç”¨çš„æ˜¯å¦ä¸€ä¸ªpiexifåº“ï¼Œ"+"\n"+
        "      åªæœ‰ä½¿ç”¨\"-use\"å‚æ•°ï¼ˆå‰é¢æåˆ°çš„â€œå‚æ•°å››â€ï¼‰ï¼Œ"+"\n"+
        "      ä¸”æŒ‡å®šä¸ºpyexiv2ï¼Œæ‰ä¼šè½¬ä¸ºç”¨pyexiv2åº“ ã€‘"+"\n"+
        "// ä¸ªäººå»ºè®®ä½¿ç”¨ç¨‹åºé»˜è®¤çš„pythonåº“piexifï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¸éœ€è¦è°ƒæ•´è¿™é¡¹è®¾ç½®ï¼Œä¸éœ€è¦åŠ è¿™ä¸ªå‚æ•°ã€‚//"+"\n \n \n"+
        "========================================================================================================"+"\n \n \n"
    ),
)

    # æ¥æ”¶è¢«å†™å…¥å›¾ç‰‡çš„è·¯å¾„
parser.add_argument(
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	# # # # #
	"-i","-I","--i","--I",
	# # # # #
    "-to","-TO","-To",
    "--to","--TO","--To",
	# # #
    "-file","-FILE","-File",
    "--file","--FILE","--File",
	# # #
    "-to_file","-TO_FILE","-To_File",
    "--to_file","--TO_FILE","--To_File",
	"-to-file","-TO-FILE","-To-File",
    "--to-file","--TO-FILE","--To-File",
	# # #
    "-img","-IMG","-Img",
    "--img","--IMG","--Img",
	# # #
	"-to_img","-TO_IMG","-To_Img",
    "--to_img","--TO_IMG","--To_Img",
	"-to-img","-TO-IMG","-To-Img",
    "--to-img","--TO-IMG","--To-Img",
	# # #
    "-jpg","-JPG","-jpg",
    "--jpg","--JPG","--jpg",
	# # #
	"-to_jpg","-TO_JPG","-To_Jpg",
    "--to_jpg","--TO_JPG","--To_Jpg",
	"-to-jpg","-TO-JPG","-To-Jpg",
    "--to-jpg","--TO-JPG","--To-Jpg",
	# # #
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    # metavar="ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘",,åŠ ä¸Šçš„è¯çœ‹èµ·æ¥å¤ªä¹±ã€‚
    dest="file",type=str,default=None,
    help=str(
            "\n"+
			"å‚æ•°ä¸€ã€æŒ‡å®šå›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼ˆå¿…è¦çš„å‘½ä»¤å…³é”®å­—ï¼ï¼‰ï¼š"+"\n"+
			"\n"+
            "æ ¼å¼ï¼šã€å‚æ•°å‘½ä»¤å…³é”®å­—ã€‘+[ç©ºæ ¼]+ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘"+"\n"+
            "ä¸Šé¢åˆ—å‡ºçš„å‘½ä»¤å…³é”®å­—å‡å¯ä½¿ç”¨ï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚"+"\n"+
            "\n"+
            "â˜…â˜†ã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘æ”¯æŒç›¸å¯¹è·¯å¾„ã€‚â˜…â˜†"+"\n"+
            "\n"+
            "ä¸¾ä¾‹ï¼ŒæŒ‡å®šå†…å®¹æ‰€å†™å…¥åˆ°çš„exifé¡¹ç›®åç§°ï¼ˆæ ‡é¢˜ï¼‰ï¼š"+"\n"+
            "  1. -i \"D:\\123\\456.jpg\" "+"\n"+
            "  2. -to \"D:\\123\\456.jpg\" "+"\n"+
            "  3. -img \"folder\\test.jpg\" "+"\n"+
            "  4. -file \"D:\\123\\456.jpg\" "+"\n"+
			"\n"+
            "{å»ºè®®ç»™è¾“å…¥çš„è·¯å¾„å‰ååŠ ä¸Šè‹±æ–‡åŒå¼•å·\"\"ï¼Œå‘½ä»¤å…³é”®å­—å¯ä¸åŠ \"\"ã€‚}"+"\n"
            +"\n\n\n\n\n"
            )
)

# æ¥æ”¶å†™å…¥åˆ°è¿™ä¸ªexifæ ‡ç­¾é‡Œçš„æ–‡æœ¬å†…å®¹
parser.add_argument(
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	# # # # #
    "-write","-WRITE","-Write",
    "--write","--WRITE","--Write",
	# # #
    "-content","-CONTENT","-Content",
    "-text","-TEXT","-Text",
    "-string","-STRING","-String","-str","-STR","-Str",
	# # #
    "--content","--CONTENT","--Content",
    "--text","--TEXT","--Text",
    "--string","--STRING","--String","--str","--STR","--Str",
	# # #
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    # metavar="ã€æ–‡æœ¬å†…å®¹ã€‘",åŠ ä¸Šçš„è¯çœ‹èµ·æ¥å¤ªä¹±ã€‚
    dest="content",type=str,default=None,
    help=str(
            "\n"+
			"å‚æ•°äºŒã€æŒ‡å®šå†™å…¥åˆ°exifæ ‡ç­¾é‡Œçš„æ–‡æœ¬å†…å®¹ï¼ˆå¿…è¦çš„å‘½ä»¤å‚æ•°ï¼ï¼‰ï¼š"+"\n"+
			"\n"+
            "æ ¼å¼ï¼šã€å‚æ•°å‘½ä»¤å…³é”®å­—ã€‘+[ç©ºæ ¼]+ã€æ–‡æœ¬å†…å®¹ã€‘"+"\n"+
            "ä¸Šé¢åˆ—å‡ºçš„å‘½ä»¤å…³é”®å­—å‡å¯ä½¿ç”¨ï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚"+"\n"+
            "\n"+
            "æ‰€æœ‰è¾“å…¥çš„æ–‡æœ¬å†…å®¹æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚"+"\n"+
            "\n"+
            "ä¸¾ä¾‹ï¼š"+"\n"+
            "1. -content \"123456æµ‹è¯•\" "+"\n"+
            "2. --text \"123456\" "+"\n"+
            "3. -write \"2023-01-01 00:00:01\" "+"\n"+
            "4. --string \"abcdefgh\" "+"\n"+
            "\n"+
            "{å»ºè®®ç»™è¾“å…¥çš„å†…å®¹å‰ååŠ ä¸Šè‹±æ–‡åŒå¼•å·\"\"ï¼Œå‘½ä»¤å…³é”®å­—å¯ä¸åŠ \"\"ã€‚}"+"\n"
            +"\n\n\n\n\n"
            )
)

# æ¥æ”¶exifçš„æ ‡ç­¾å
parser.add_argument(
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	# # # # #
    "-tag","-TAG","-Tag",
    "--tag","--TAG","--Tag",
	# # #
    "-write_tag","-WRITE_TAG","-Write_Tag",
    "-write-tag","-WRITE-TAG","-Write-Tag",
	# # #
    "--write_tag","--WRITE_TAG","--Write_Tag",
    "--write-tag","--WRITE-TAG","--Write-Tag",
	# # #
    "-to_tag","-TO_TAG","-To_Tag",
    "-to-tag","-TO-TAG","-To-Tag",
	# # #
    "--to_tag","--TO_TAG","--To_Tag",
    "--to-tag","--TO-TAG","--To-Tag",
	# # #
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    # metavar="ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘",,åŠ ä¸Šçš„è¯çœ‹èµ·æ¥å¤ªä¹±ã€‚
    dest="tag",type=str,default="2",
    help=str(
            "\n"+
			"å‚æ•°ä¸‰ã€æŒ‡å®šæ–‡æœ¬å†…å®¹æ‰€å†™å…¥åˆ°çš„exifæ ‡ç­¾çš„åç§°ï¼ˆå¯é€‰ï¼Œéå¿…è¦çš„å‘½ä»¤å‚æ•°ï¼‰ï¼š"+"\n"+
			"\n"+
            "æ ¼å¼ï¼šã€å‚æ•°å‘½ä»¤å…³é”®å­—ã€‘+[ç©ºæ ¼]+ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘"+"\n"+
            "ä¸Šé¢åˆ—å‡ºçš„å‘½ä»¤å…³é”®å­—å‡å¯ä½¿ç”¨ï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚"+"\n"+
            "\n"+
            "ä¸‹é¢åˆ—å‡ºçš„æ˜¯æ¯ä¸€ç±»æ ‡ç­¾æ‰€å¯¹åº”çš„åç§°ã€ä»£å·æˆ–ç¼–å·çš„å¯ç”¨å€¼ï¼Œè¾“å…¥å€¼ç”¨â€œã€ã€‘â€æ‹¬å‡ºã€‚"+"\n"+
            "æ ‡é¢˜:ã€æ ‡é¢˜ã€‘ã€ã€1ã€‘ã€ã€40091ã€‘ã€ã€Titleã€‘ã€ã€XPTitleã€‘ï¼›"+"\n"+
            "å¤‡æ³¨:ã€å¤‡æ³¨ã€‘ã€ã€2ã€‘ã€ã€40092ã€‘ã€ã€Commentã€‘ã€ã€XPCommentã€‘ï¼›"+"\n"+
            "ä½œè€…:ã€ä½œè€…ã€‘ã€ã€3ã€‘ã€ã€40093ã€‘ã€ã€Authorã€‘ã€ã€XPAuthorã€‘ï¼›"+"\n"+
            "æ ‡è®°:ã€æ ‡è®°ã€‘ã€ã€4ã€‘ã€ã€40094ã€‘ã€ã€Keywordsã€‘ã€ã€XPKeywordsã€‘ï¼›"+"\n"+
            "ä¸»é¢˜:ã€ä¸»é¢˜ã€‘ã€ã€5ã€‘ã€ã€40095ã€‘ã€ã€Subjectã€‘ã€ã€XPSubjectã€‘ã€‚"+"\n"+
            "\n"+
            "ä¸¾ä¾‹ï¼ŒæŒ‡å®šæ–‡æœ¬å†…å®¹æ‰€å†™å…¥åˆ°çš„exifæ ‡ç­¾ä¸ºã€æ ‡é¢˜ã€‘ï¼š"+"\n"+
            "  1. -write_tag \"æ ‡é¢˜\" "+"\n"+
            "  2. --write_tag \"Title\" "+"\n"+
            "  3. -tag \"æ ‡é¢˜\" "+"\n"+
            "  4. --tag \"1\" "+"\n"+
            "  5. -to_tag \"40091\" "+"\n"+
            "  6. --to_tag \"XPTitle\" "+"\n"+
			"\n"+
			"â˜…â˜† æ³¨æ„ï¼å¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç¨‹åºä¼šé€‰æ‹©ï¼šã€å¤‡æ³¨ã€‘ â˜…â˜†"+
			"\n"+
            "{å»ºè®®ç»™è¾“å…¥çš„å†…å®¹å‰ååŠ ä¸Šè‹±æ–‡åŒå¼•å·\"\"ï¼Œå‘½ä»¤å…³é”®å­—å¯ä¸åŠ \"\"ã€‚}"+"\n"
            +"\n\n\n\n\n"
            )
)


# æ¥æ”¶ç”¨æ¥æ“ä½œçš„pythonåº“çš„é€‰é¡¹
parser.add_argument(
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	# # # # #
    "-use","-USE","-Use",
    "--use","--USE","--Use",
	# # #
    "-lib","-LIB","-Lib",
    "--lib","--LIB","--Lib",
	# # #
    "-use_lib","-USE_LIB","-Use_Lib",
    "--use-lib","--USE-LIB","--Use-Lib",
	# # #
	##â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    # metavar="ã€1 / p1 / pie / pi / piexif / â€¦â€¦ã€‘",åŠ ä¸Šçš„è¯çœ‹èµ·æ¥å¤ªä¹±ã€‚
    dest="lib",type=str,default="1",
    help=str(
            "\n"+
			"å‚æ•°å››ã€æŒ‡å®šç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ï¼Œç›¸å½“äºæ¨¡å¼åˆ‡æ¢ï¼ˆå¯é€‰ï¼Œéå¿…è¦çš„å‘½ä»¤å‚æ•°ï¼‰ï¼š"+"\n"+
			"\n"+
            "æ ¼å¼ï¼šã€å‚æ•°å‘½ä»¤å…³é”®å­—ã€‘+[ç©ºæ ¼]+ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘"+"\n"+
            "ä¸Šé¢åˆ—å‡ºçš„å‘½ä»¤å…³é”®å­—å‡å¯ä½¿ç”¨ï¼Œå­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚"+"\n"+
            "\n"+
            "ä¸‹é¢åˆ—å‡ºçš„æ˜¯æ¯ä¸€ä¸ªpythonåº“æ‰€å¯¹åº”çš„å¯ç”¨è¾“å…¥å€¼ï¼Œè¾“å…¥å€¼ç”¨â€œã€ã€‘â€æ‹¬å‡ºã€‚"+"\n"+
            "piexif: ã€1ã€‘ã€ã€p1ã€‘ã€ã€pieã€‘ã€ã€piã€‘ã€ã€piexifã€‘ï¼›"+"\n"+
            "pyexiv2:ã€2ã€‘ã€ã€p2ã€‘ã€ã€pyeã€‘ã€ã€pyã€‘ã€ã€pyexiv2ã€‘ã€ã€py2ã€‘ã€‚"+"\n"+
            "\n"+
            "ä¸¾ä¾‹ï¼š"+"\n"+
            "1. -use \"2\" "+"\n"+
            "2. --lib \"p2\" "+"\n"+
            "3. -use \"pyexiv2\" "+"\n"+
            "4. --use_lib \"pie\" "+"\n"+
            "\n"+
            "{å»ºè®®ç»™è¾“å…¥çš„å†…å®¹å‰ååŠ ä¸Šè‹±æ–‡åŒå¼•å·\"\"ï¼Œå‘½ä»¤å…³é”®å­—å¯ä¸åŠ \"\"ã€‚}"+"\n"+
            "\n"+
            "ä¸ªäººå»ºè®®ä½¿ç”¨ç¨‹åºé»˜è®¤çš„pythonåº“piexifï¼Œä¹Ÿå°±æ˜¯å¦‚æœä¸éœ€è¦è°ƒæ•´è¿™é¡¹è®¾ç½®ï¼Œä¸éœ€è¦åŠ è¿™ä¸ªå‚æ•°ã€‚"+"\n"
            +"\n\n\n\n\n"
            )
)
# å¼€å§‹è§£æ
args = parser.parse_args()

# å¦‚æœargparseæ¨¡å—æ¥æ”¶åˆ°â€œ-hâ€è·å–å¸®åŠ©æŒ‡ä»¤ï¼Œå°±ä¼šé€€å‡ºï¼Œä»£ç ä¸ä¼šè¿è¡Œåˆ°è¿™é‡Œã€‚
# å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°æµ‹è¯•
# print(args.file)
# print(args.content)
# print(args.tag)
# print(args.lib)

## åˆ†æä¼ è¿‡æ¥çš„å‚æ•°
# æ£€æŸ¥æ˜¯å¦ç¼ºå°‘å‚æ•°ï¼Œå¹¶ä¼ é€’å€¼
if (args.file == None) or (args.content == None):
    print("æœªæŒ‡å®šã€å›¾ç‰‡æ–‡ä»¶è·¯å¾„ã€‘æˆ–å†™å…¥çš„ã€æ–‡æœ¬å†…å®¹ã€‘")
    sys.exit(1)
else:
    input_file = args.file
    input_content = args.content

# æ£€æŸ¥å¹¶ä¼ é€’tag
if   ((args.tag == "æ ‡é¢˜") or (args.tag == "1") or 
    (args.tag == "40091") or (args.tag.lower() == "title") or (args.tag.lower() == "xptitle")):
    input_tag = int(1)
elif ((args.tag == "å¤‡æ³¨") or (args.tag == "2") or 
    (args.tag == "40092") or (args.tag.lower() == "comment") or (args.tag.lower() == "xpcomment")):
    input_tag = int(2)
elif ((args.tag == "ä½œè€…") or (args.tag == "3") or 
    (args.tag == "40093") or (args.tag.lower() == "author") or (args.tag.lower() == "xpauthor")):
    input_tag = int(3)
elif ((args.tag == "æ ‡è®°") or (args.tag == "4") or 
    (args.tag == "40094") or (args.tag.lower() == "keywords") or (args.tag.lower() == "xpkeywords")):
    input_tag = int(4)
elif ((args.tag == "ä¸»é¢˜") or (args.tag == "5") or 
    (args.tag == "40095") or (args.tag.lower() == "subject") or (args.tag.lower() == "xpsubject")):
    input_tag = int(5)
else:
    print("å‚æ•°ã€é€‰ä¸­çš„exifæ ‡ç­¾åç§°ã€ä»£å·æˆ–ç¼–å·ã€‘æŒ‡å®šé”™è¯¯")
    sys.exit(1)

# æ£€æŸ¥å¹¶ä¼ é€’lib
if   ((args.lib == "1") or (args.lib.lower() == "p1") or 
    (args.lib.lower() == "pie") or (args.lib.lower() == "pi") or (args.lib.lower() == "piexif")):
    input_lib = int(1)
elif ((args.lib == "2") or (args.lib.lower() == "p2") or (args.lib.lower() == "py2")
    (args.lib.lower() == "pye") or (args.lib.lower() == "py") or (args.lib.lower() == "pyexiv2")):
    input_lib = int(2)
else:
    print("å‚æ•°ã€ç”¨æ¥è¿›è¡Œå†™å…¥æ“ä½œçš„pythonåº“ã€‘æŒ‡å®šé”™è¯¯")
    sys.exit(1)


# ä¼ å…¥å‡½æ•°å‚æ•°ï¼Œè¿™é‡Œå› ä¸ºæ˜¯éœ€è¦cmdå‘½ä»¤è¡Œä¼ å…¥ï¼Œæ‰€ä»¥è¿™ä¹ˆå†™ã€‚
# å¦‚æœç§»æ¤åˆ°ä½ çš„pythonæºä»£ç é‡Œï¼Œè¿™é‡Œå°±æ˜¯å¡«å†™ä¼ é€’ç»™å‡½æ•°å‚æ•°çš„åœ°æ–¹ã€‚
img_path_full = input_file
choice = input_tag
contents_written_into = input_content


# æ ¹æ®é€‰æ‹©çš„pythonåº“æ‰§è¡Œå†™å…¥
if input_lib == 1:
    errorlevel = pv1_write(img_path_full,choice,contents_written_into)
else:
    errorlevel = pv2_write(img_path_full,choice,contents_written_into)

if errorlevel != 0:
    print(str(img_path_full + "  è¿è¡Œé”™è¯¯"))

sys.exit(int(errorlevel))